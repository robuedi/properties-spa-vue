var ee=Object.defineProperty;var te=(n,l,e)=>l in n?ee(n,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[l]=e;var z=(n,l,e)=>(te(n,typeof l!="symbol"?l+"":l,e),e);import{H as F,I as E,G as R,r as v,o as O,c as h,g as $,b as A,d as p,x as G,e as r,t as W,J as L,a as C,w as T,m as B,K as re,L as oe,M as ne,h as le,E as H,N as se,f as K,F as ie}from"./index-a0f5dad9.js";import{M as j,U as Q}from"./UserProperty-b5e8fcbd.js";import{u as J,c as M,a as q,b as N}from"./index.esm-93490f75.js";class D extends j{resource(){return"property-types"}}const ae=F("propertyType",{state:()=>({propertyTypes_:[],apiState:D.state.INITIAL}),getters:{propertyTypes:n=>n.propertyTypes_},actions:{async getAll(n=D.select("id","name")){return this.apiState=D.state.LOADING,new Promise((l,e)=>{n.get().then(t=>{this.propertyTypes_=t.data,this.apiState=D.state.LOADED,l(t)}).catch(t=>{this.propertyTypes_=[],this.apiState=D.state.ERROR,e(t)})})}}}),ue={class:"flex items-center"},pe=$("span",{class:"mr-6"},"Type",-1),de={class:"p-error"},me={__name:"PropertyTypeInput",props:["value","error"],emits:["input","blur"],setup(n,{emit:l}){const e=n,t=E({get(){return e.value},set(_){l("input",_)}}),a=ae();return R(()=>{a.getAll()}),(_,i)=>{const d=v("SelectButton");return O(),h("div",null,[$("div",ue,[pe,A(),p(d,{class:G({"p-invalid":e.error}),id:"inp-prop-type",onBlur:i[0]||(i[0]=m=>l("blur")),modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=m=>t.value=m),options:r(a).propertyTypes,optionValue:"id",optionLabel:"name"},null,8,["class","modelValue","options"])]),$("small",de,W(e.error),1)])}}};class k extends j{constructor(){super(...arguments);z(this,"name","")}resource(){return"listing-types"}}const X=F("listingType",{state:()=>({listingTypes_:[],apiState:k.state.INITIAL}),getters:{listingTypes:n=>n.listingTypes_,rentItem:n=>n.listingTypes_.find(l=>l.name.toLowerCase()==="rent"),sellItem:n=>n.listingTypes_.find(l=>l.name.toLowerCase()==="sell")},actions:{async getAll(n=k.select("id","name")){return this.apiState=k.state.LOADING,new Promise((l,e)=>{n.get().then(t=>{this.listingTypes_=t.data,this.apiState=k.state.LOADED,l(t)}).catch(t=>{this.listingTypes_=[],this.apiState=k.state.ERROR,e(t)})})}}}),ce={class:"flex items-center"},ye=$("span",{class:"mr-6"},"Listing",-1),_e={class:"p-error"},fe={__name:"ListingTypeInput",props:["value","error"],emits:["input","blur"],setup(n,{emit:l}){const e=n,t=E({get(){return e.value},set(_){l("input",_)}}),a=X();return R(()=>{a.getAll()}),(_,i)=>{const d=v("SelectButton");return O(),h("div",null,[$("div",ce,[ye,A(),p(d,{class:G({"p-invalid":e.error}),onBlur:i[0]||(i[0]=m=>l("blur")),id:"listing_id",modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=m=>t.value=m),options:r(a).listingTypes,optionValue:"id",optionLabel:"name"},null,8,["class","modelValue","options"])]),$("small",_e,W(e.error),1)])}}},ve={__name:"PropertyForm",props:{modelValue:{type:Object,required:!0,default:{name:null,description:null,bedrooms:null,bathrooms:null,listing_type_id:null,property_type_id:null,is_public:!1}},error:{type:Object,required:!1,default:{name:[],description:[],bedrooms:[],bathrooms:[],listing_type_id:[],property_type_id:[]}}},setup(n,{emit:l}){const e=n,t=(f,s)=>{l("update:modelValue",{...e.modelValue,[f]:s})},{setErrors:a,defineInputBinds:_,validateField:i,errors:d}=J({validationSchema:M({name:q().required(),description:q().required(),property_type_id:q().required(),listing_type_id:q().required(),bathrooms:N().required(),bedrooms:N().required()})}),m=f=>_(f,{validateOnValueUpdate:!1,validateOnInput:!1}),V=m("name"),c=m("property_type_id"),g=m("listing_type_id"),S=m("description"),u=m("bathrooms"),o=m("bedrooms");return L(()=>e.error,f=>{a(JSON.parse(JSON.stringify(f)))}),(f,s)=>{const w=v("InputSwitch2"),x=v("TextInput"),b=v("TextareaInput"),y=v("NumberInput"),Y=v("BasicForm"),Z=v("Card");return O(),C(Z,null,{title:T(()=>[A(" Details ")]),content:T(()=>[p(Y,null,{default:T(()=>[p(w,{label:"Is Public",modelValue:e.modelValue.is_public,"onUpdate:modelValue":s[0]||(s[0]=I=>t("is_public",I))},null,8,["modelValue"]),p(x,B({name:"Name",error:r(d).name},r(V),{onBlur:s[1]||(s[1]=I=>r(i)("name")),value:e.modelValue.name,onInput:s[2]||(s[2]=I=>t("name",I))}),null,16,["error","value"]),p(me,B({error:r(d).property_type_id},r(c),{onBlur:s[3]||(s[3]=I=>r(i)("property_type_id")),value:e.modelValue.property_type_id,onInput:s[4]||(s[4]=I=>t("property_type_id",I))}),null,16,["error","value"]),p(fe,B({error:r(d).listing_type_id},r(g),{onBlur:s[5]||(s[5]=I=>r(i)("listing_type_id")),value:e.modelValue.listing_type_id,onInput:s[6]||(s[6]=I=>t("listing_type_id",I))}),null,16,["error","value"]),p(b,B({name:"Description",error:r(d).description},r(S),{onBlur:s[7]||(s[7]=I=>r(i)("description")),value:e.modelValue.description,onInput:s[8]||(s[8]=I=>t("description",I))}),null,16,["error","value"]),p(y,B({name:"Number of Bedrooms",error:r(d).bedrooms},r(o),{onBlur:s[9]||(s[9]=I=>r(i)("bedrooms")),modelValue:e.modelValue.bedrooms,onInput:s[10]||(s[10]=I=>t("bedrooms",I))}),null,16,["error","modelValue"]),p(y,B({name:"Number of Bathrooms",error:r(d).bathrooms},r(u),{onBlur:s[11]||(s[11]=I=>r(i)("bathrooms")),modelValue:e.modelValue.bathrooms,onInput:s[12]||(s[12]=I=>t("bathrooms",I))}),null,16,["error","modelValue"])]),_:1})]),_:1})}}};class P extends j{resource(){return"cities"}}const Ve=F("city",{state:()=>({cities_:[],apiState:P.state.INITIAL}),getters:{cities:n=>n.cities_},actions:{async getAll(n=P.select("id","name","country_id")){return this.apiState=P.state.LOADING,new Promise((l,e)=>{n.get().then(t=>{this.cities_=t.data,this.apiState=P.state.LOADED,l(t)}).catch(t=>{this.cities_=[],this.apiState=P.state.ERROR,e(t)})})}}}),be={class:"flex flex-col"},Ie={__name:"CityInput",props:{value:{type:[Number],required:!1,default:null},countryId:{type:Number,required:!1,default:null},disabled:{type:Boolean,required:!1,default:!1},error:{type:String,required:!1,default:""}},emits:["input","blur"],setup(n,{emit:l}){const e=n,t=E({get(){return e.value},set(i){l("input",i)}}),a=Ve(),_=()=>{e.countryId?a.getAll(P.where({country_id:e.countryId})):a.getAll(new P)};return L(()=>e.countryId,()=>{t.value=null,_()}),R(()=>{_()}),re(()=>{t.value=null}),(i,d)=>{const m=v("Dropdown");return O(),h("div",be,[p(oe,null,{default:T(()=>[A("City")]),_:1}),p(m,{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=V=>t.value=V),disabled:e.disabled,class:G({"p-invalid":e.error}),onBlur:d[1]||(d[1]=V=>l("blur")),showClear:"",options:r(a).cities,filter:"",optionValue:"id",optionLabel:"name",placeholder:"Please select"},null,8,["modelValue","disabled","class","options"]),p(ne,null,{default:T(()=>[A(W(e.error),1)]),_:1})])}}};class U extends j{resource(){return"countries"}}const ge=F("country",{state:()=>({countries_:[],apiState:U.state.INITIAL}),getters:{countries:n=>n.countries_},actions:{async getAll(n=U.select("id","name")){return this.apiState=U.state.LOADING,new Promise((l,e)=>{n.get().then(t=>{this.countries_=t.data,this.apiState=U.state.LOADED,l(t)}).catch(t=>{this.countries_=[],this.apiState=U.state.ERROR,e(t)})})}}}),Se={__name:"CountryInput",props:["modelValue"],emits:["update:modelValue"],setup(n,{emit:l}){const e=n,t=E({get(){return e.modelValue},set(_){l("update:modelValue",_)}}),a=ge();return R(()=>{a.getAll()}),(_,i)=>{const d=v("Dropdown"),m=v("InputWrapper");return O(),C(m,{name:"Country"},{default:T(()=>[p(d,{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=V=>t.value=V),showClear:"",options:r(a).countries,filter:"",optionValue:"id",optionLabel:"name",placeholder:"Please select",class:"w-full"},null,8,["modelValue","options"])]),_:1})}}},Be={__name:"AddressForm",props:{modelValue:{type:Object,required:!0,default:{country:null,city_id:null,street_nr:null,street_name:null,postcode:null}},error:{type:Object,required:!1,default:{}}},setup(n,{emit:l}){const e=n,t=(u,o)=>{l("update:modelValue",{...e.modelValue,[u]:o})};L(e.modelValue,u=>{(u==null?void 0:u.country)===null&&t("city_id",null),(u==null?void 0:u.city_id)===null&&(t("street_nr",null),t("street_name",null),t("postcode",null))});const{setErrors:a,defineInputBinds:_,validateField:i,errors:d}=J({validationSchema:M({city_id:q().required(),street_name:q().required(),street_nr:q().required(),postcode:q().required()})}),m=u=>_(u,{validateOnValueUpdate:!1,validateOnInput:!1}),V=m("city_id"),c=m("street_name"),g=m("street_nr"),S=m("postcode");return L(()=>e.error,u=>{a(JSON.parse(JSON.stringify(u)))}),(u,o)=>{const f=v("TextInput"),s=v("BasicForm"),w=v("Card");return O(),C(w,null,{title:T(()=>[A(" Address ")]),content:T(()=>[p(s,null,{default:T(()=>{var x,b;return[p(Se,{modelValue:e.modelValue.country,"onUpdate:modelValue":o[0]||(o[0]=y=>t("country",y))},null,8,["modelValue"]),p(Ie,B({disabled:!e.modelValue.country,error:r(d).city_id},r(V),{onBlur:o[1]||(o[1]=y=>r(i)("city_id")),value:e.modelValue.city_id,onInput:o[2]||(o[2]=y=>t("city_id",y)),"country-id":(b=(x=e.modelValue)==null?void 0:x.country)==null?void 0:b.id}),null,16,["disabled","error","value","country-id"]),p(f,B({name:"Street Name",error:r(d).street_name},r(c),{onBlur:o[3]||(o[3]=y=>r(i)("street_name")),disabled:!e.modelValue.city_id,value:e.modelValue.street_name,onInput:o[4]||(o[4]=y=>t("street_name",y))}),null,16,["error","disabled","value"]),p(f,B({name:"Street Number",error:r(d).street_nr},r(g),{onBlur:o[5]||(o[5]=y=>r(i)("street_nr")),disabled:!e.modelValue.city_id,value:e.modelValue.street_nr,onInput:o[6]||(o[6]=y=>t("street_nr",y))}),null,16,["error","disabled","value"]),p(f,B({name:"Postcode",error:r(d).postcode},r(S),{onBlur:o[7]||(o[7]=y=>r(i)("postcode")),disabled:!e.modelValue.city_id,value:e.modelValue.postcode,onInput:o[8]||(o[8]=y=>t("postcode",y))}),null,16,["error","disabled","value"])]}),_:1})]),_:1})}}},Te={__name:"RentListingForm",props:{modelValue:{type:Object,required:!0,default:{price_weekly:null,price_monthly:null,deposit:null,minimum_tenancy:null,pets_allowed:null}},error:{type:Object,required:!1,default:{}}},setup(n,{emit:l}){const e=n,t=(u,o)=>{l("update:modelValue",{...e.modelValue,[u]:o})},{setErrors:a,defineInputBinds:_,validateField:i,errors:d}=J({validationSchema:M({price_weekly:N().when("price_monthly",{is:u=>u.trim()==="",then:N().required("Weekly price is required if monthly price is not set.")}),price_monthly:N().when("price_weekly",{is:u=>u.trim()==="",then:N().required("Monthly price is required if weekly price is not set.")}),deposit:N().required(),minimum_tenancy:N().required()})}),m=u=>_(u,{validateOnValueUpdate:!1,validateOnInput:!1}),V=m("price_weekly"),c=m("price_monthly"),g=m("deposit"),S=m("minimum_tenancy");return L(()=>e.error,u=>{a(JSON.parse(JSON.stringify(u)))}),(u,o)=>{const f=v("NumberInput"),s=v("InputSwitch2"),w=v("BasicForm"),x=v("Card");return O(),C(x,null,{title:T(()=>[A(" Rent Details ")]),content:T(()=>[p(w,null,{default:T(()=>[p(f,B({name:"Weekly Price",error:r(d).price_weekly},r(V),{onBlur:o[0]||(o[0]=b=>r(i)("price_weekly")),modelValue:e.modelValue.price_weekly,onInput:o[1]||(o[1]=b=>t("price_weekly",b))}),null,16,["error","modelValue"]),p(f,B({name:"Monthly Price",error:r(d).price_monthly},r(c),{onBlur:o[2]||(o[2]=b=>r(i)("price_monthly")),modelValue:e.modelValue.price_monthly,onInput:o[3]||(o[3]=b=>t("price_monthly",b))}),null,16,["error","modelValue"]),p(f,B({name:"Deposit",error:r(d).deposit},r(g),{onBlur:o[4]||(o[4]=b=>r(i)("deposit")),modelValue:e.modelValue.deposit,onInput:o[5]||(o[5]=b=>t("deposit",b))}),null,16,["error","modelValue"]),p(f,B({name:"Minimum Tenancy",error:r(d).minimum_tenancy},r(S),{onBlur:o[6]||(o[6]=b=>r(i)("minimum_tenancy")),modelValue:e.modelValue.minimum_tenancy,onInput:o[7]||(o[7]=b=>t("minimum_tenancy",b))}),null,16,["error","modelValue"]),p(s,{label:"Pets Allowed",modelValue:e.modelValue.pets_allowed,"onUpdate:modelValue":o[8]||(o[8]=b=>t("pets_allowed",b))},null,8,["modelValue"])]),_:1})]),_:1})}}},$e={__name:"SellListing",props:{modelValue:{type:Object,required:!0,default:{price:null}},error:{type:Object,required:!1,default:{}}},setup(n,{emit:l}){const e=n,t=(V,c)=>{l("update:modelValue",{...e.modelValue,[V]:c})},{setErrors:a,defineInputBinds:_,validateField:i,errors:d}=J({validationSchema:M({price:N().required()})}),m=_("price",{validateOnValueUpdate:!1,validateOnInput:!1});return L(()=>e.error,V=>{a(JSON.parse(JSON.stringify(V)))}),(V,c)=>{const g=v("NumberInput"),S=v("BasicForm"),u=v("Card");return O(),C(u,null,{title:T(()=>[A(" Sell Details ")]),content:T(()=>[p(S,null,{default:T(()=>[p(g,B({name:"Price",error:r(d).price},r(m),{onBlur:c[0]||(c[0]=o=>r(i)("price")),modelValue:e.modelValue.price,onInput:c[1]||(c[1]=o=>t("price",o))}),null,16,["error","modelValue"])]),_:1})]),_:1})}}},Oe=F("userProperty",{actions:{async store(n){return new Promise((l,e)=>{new Q(n).save().then(a=>{l(a)}).catch(a=>{e(a)})})},async getAll(n=Q.get()){return new Promise((l,e)=>{n.then(t=>{l(t)}).catch(t=>{e(t)})})}}}),we={class:"flex"},xe={class:"flex items-center mb-6"},Ne=$("h1",{class:"grow"},"Add Property",-1),qe={class:"flex items-start flex-wrap md:flex-nowrap space-y-8 md:space-x-8 md:space-y-0"},Ae={class:"flex flex-col md:basis-1/2 basis-full space-y-8"},ke={__name:"PropertiesAdd",setup(n){const l=X(),e=le(),t=H([{icon:"pi pi-home",command:()=>{e.push({name:"home"})}},{label:"My Properties",command:()=>{e.push({name:"properties"})}},{label:"Add Property"}]),a=se({property:{},address:{},rent_listing:{},sell_listing:{}}),_=(V,c)=>{for(let g in c)a[V][g]=c[g]};let i=H({});const d=Oe(),m=()=>{let V={...a};delete V.property,d.store({...a.property,...V}).catch(c=>{var u,o;let g=((o=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:o.errors)??{},S={};for(let f in g){let s=f.split(".");if(s.length===1)S[f]=g[f];else{let w=s.slice(1).join(".");s[0]in S||(S[s[0]]={}),S[s[0]][w]=g[f]}}i.value=S})};return(V,c)=>{var u,o,f,s,w,x,b;const g=v("Breadcrumb"),S=v("Button");return O(),h(ie,null,[$("div",we,[p(g,{model:t.value},null,8,["model"])]),$("div",xe,[Ne,p(S,{label:"Save",icon:"pi pi-save",severity:"success",onClick:c[0]||(c[0]=y=>m())})]),$("div",qe,[p(ve,{error:r(i),modelValue:a.property,"onUpdate:modelValue":c[1]||(c[1]=y=>_("property",y)),class:"md:basis-1/2 basis-full"},null,8,["error","modelValue"]),$("div",Ae,[p(Be,{error:(u=r(i))==null?void 0:u.address,modelValue:a.address,"onUpdate:modelValue":c[2]||(c[2]=y=>_("address",y))},null,8,["error","modelValue"]),((o=r(l).rentItem)==null?void 0:o.id)===((f=a.property)==null?void 0:f.listing_type_id)?(O(),C(Te,{key:0,error:(s=r(i))==null?void 0:s.rent_listing,modelValue:a.rent_listing,"onUpdate:modelValue":c[3]||(c[3]=y=>_("rent_listing",y)),class:"md:basis-1/2 basis-full"},null,8,["error","modelValue"])):K("",!0),((w=r(l).sellItem)==null?void 0:w.id)===((x=a.property)==null?void 0:x.listing_type_id)?(O(),C($e,{key:1,error:(b=r(i))==null?void 0:b.sell_listing,modelValue:a.sell_listing,"onUpdate:modelValue":c[4]||(c[4]=y=>_("sell_listing",y)),class:"md:basis-1/2 basis-full"},null,8,["error","modelValue"])):K("",!0)])])],64)}}};export{ke as default};
